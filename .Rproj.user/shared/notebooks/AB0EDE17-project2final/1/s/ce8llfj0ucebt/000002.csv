"0","set.seed(1234)"
"0","k=10"
"0",""
"0","data <- headache4[sample(nrow(headache4)),]"
"0","fold <- cut(seq(1:nrow(headache4)), breaks=k, labels=F)"
"0","val <- NULL"
"0","for(i in 1:k){"
"0","  trainset <- data[fold!=i,]"
"0","  testset <- data[fold==i,]"
"0","  truth <- testset$headache_occur"
"0","  fit4 <- glm(headache_occur~medication+time, data=trainset, family=""binomial"")"
"0","  prob <- predict(fit4, newdata=testset, type=""response"")"
"0","  val <- rbind(val, class_diag(prob, truth))"
"0","}"
"0","summarize_all(val, mean)"
