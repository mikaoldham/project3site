"0","library(knitr)"
"0","hook_output = knit_hooks$get('output')"
"0","knit_hooks$set(output = function(x, options) {"
"0","  # this hook is used only when the linewidth option is not NULL"
"0","  if (!is.null(n <- options$linewidth)) {"
"0","    x = knitr:::split_lines(x)"
"0","    # any lines wider than n should be wrapped"
"0","    if (any(nchar(x) > n)) x = strwrap(x, width = n)"
"0","    x = paste(x, collapse = '\n')"
"0","  }"
"0","  hook_output(x, options)"
"0","})"
"0",""
"0","knitr::opts_chunk$set(echo = TRUE, eval = TRUE,fig.align=""center"",warning=FALSE,message=FALSE,fig.width=8, fig.height=5, linewidth=60)"
"0","options(tibble.width = 100,width = 100)"
"0","library(tidyverse)"
"0",""
"0","class_diag <- function(probs,truth){"
"0","#CONFUSION MATRIX: CALCULATE ACCURACY, TPR, TNR, PPV"
"0","tab<-table(factor(probs>.5,levels=c(""FALSE"",""TRUE"")),truth)"
"0","acc=sum(diag(tab))/sum(tab)"
"0","sens=tab[2,2]/colSums(tab)[2]"
"0","spec=tab[1,1]/colSums(tab)[1]"
"0","ppv=tab[2,2]/rowSums(tab)[2]"
"0","if(is.numeric(truth)==FALSE & is.logical(truth)==FALSE) truth<-as.numeric(truth)-1"
"0","#CALCULATE EXACT AUC"
"0","ord<-order(probs, decreasing=TRUE)"
"0","probs <- probs[ord]; truth <- truth[ord]"
"0","TPR=cumsum(truth)/max(1,sum(truth))"
"0","FPR=cumsum(!truth)/max(1,sum(!truth))"
"0","dup<-c(probs[-1]>=probs[-length(probs)], FALSE)"
"0","TPR<-c(0,TPR[!dup],1); FPR<-c(0,FPR[!dup],1)"
"0","n <- length(TPR)"
"0","auc<- sum( ((TPR[-1]+TPR[-n])/2) * (FPR[-1]-FPR[-n]) )"
"0","data.frame(acc,sens,spec,ppv,auc)"
"0","}"
